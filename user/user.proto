syntax = "proto3";
package user;

import "google/protobuf/timestamp.proto";
import "google/api/annotations.proto";
import "google/protobuf/wrappers.proto";

message User{
    string uid = 1;
    string first_name = 2;
    string last_name = 3;
    string email = 4;
    string password = 5;
    google.protobuf.Timestamp date_of_birth = 6;
    string gender = 7;
    string phone_number = 8;
    string profile_picture_url = 9;
    bool is_verified = 10;
    bool is_suspended = 11;
    string nationality = 12;
    bool deleted_permanently = 13;
    bool is_deactivate = 14;
    google.protobuf.Timestamp created_at = 15;
}

message Balances {
    string uid = 1;
    string user_uid = 2;
    int32 amount = 3;
    google.protobuf.Timestamp updated_at = 4;
}

message LogsBalance {
    string uid = 1;
    string user_uid = 2;
    int32 amount = 3;
    string type = 4;
    string message = 5;
}

message CreateUserRequest{
    string uid = 1;
    string first_name = 2;
    string last_name = 3;
    string email = 4;
    string password = 5;
    string password_confirmation = 6;
    google.protobuf.Timestamp date_of_birth = 7;
    string gender = 8;
    string phone_number = 9;
     string nationality = 10;
}

message CreateUserResponse{
    CreateUserRequest data = 1;
    string title = 2 ;
    string code = 3 ;
}

message EmailVerificationRequest {
    string email = 1;
    string verification_token = 2;
}

message EmailVerificationResponse {
    EmailVerificationRequest data = 1;
    string title = 2;
    string code = 3;
}

message ResetPasswordTokenRequest {
    string email = 1;
    string param = 2;
}

message ResetPasswordTokenResponse {
    string title = 1;
    string code = 2; 
    ResetPasswordTokenRequest data = 3;
}

message ResetPasswordRequest {
    string param = 1;
    string email = 2;
    string reset_password_token = 3;
    string password = 4;
    string password_confirmation = 5;
}

message ResetPasswordResponse {
    ResetPasswordRequest data =1;
    string title = 2;
    string code = 3; 
}

message UpdateUserRequest{
    string uid = 1;
    string first_name = 2;
    string last_name = 3;
    string email = 4;
    string old_password = 5;
    string password = 6;
    string password_confirmation = 7;
    google.protobuf.Timestamp date_of_birth = 8;
    string gender = 9;
    string phone_number = 10;
    string profile_picture_url = 11;
    string nationality = 12;
}

message UpdateUserSettingRequest{
    string user_uid = 1;
    google.protobuf.BoolValue email_notification = 2;
    google.protobuf.BoolValue push_notification = 3;
    google.protobuf.StringValue currency_uid = 4;
    google.protobuf.StringValue language_uid = 5;
    google.protobuf.StringValue payment_type_uid = 6;
    google.protobuf.StringValue CreditCardNumber = 7;
}

message Filter{
    string Field = 1;
    string Operator =2;
    string Value = 3;
}

message BrowseRequest{
    repeated Filter filters = 1;
    int32 limit = 2;
    int32 offset = 3;
}

message UpdateUserResponse{
    UpdateUserRequest data = 1;
    string title = 2 ;
    string code = 3;
}

message UpdateUserSettingResponse{
    UpdateUserSettingRequest data = 1;
}

message BrowseUserResponse{
    repeated User data = 1;
}

message Error{
    string source = 1;
    string title = 2;
}

message GetUserByCredentialsRequest{
    string email = 1;
    string password = 2;
}

message GetUserByCredentialsResponse{
    User data = 1;
}

message GetUserRequest{
    string uid = 1;
}

message GetUserResponse{
    User data = 1;
}

message OldUser{
    string uid = 1;
    string user_uid = 2;
    string first_name = 3;
    string last_name = 4;
    string email = 5;
    string phone_number = 6;
    string business_name = 7;
    string business_category = 8;
    string business_address = 9;
    string business_about = 10;
    string profile_picture_url = 11;
    string nationality = 12;
    google.protobuf.Timestamp join_at = 13;
    bool is_verified = 14;
    google.protobuf.Timestamp created_at = 15;
}

message ResendEmailVerificationRequest{
    string uid = 1;
    string email = 2;
    string verification_token = 3;
}

message ResendEmailVerificationRespone{
    ResendEmailVerificationRequest data = 1;
    string code = 2;
    string title = 3;
    }

message GetUserInfoRespone{
    ResponseUser data = 1;
    string code = 2;
    string title = 3;
}

message CreateUserHostRequest{
    string uid = 1;
    string first_name = 2;
    string last_name = 3;
    string email = 4;
    string password = 5;
    string password_confirmation = 6;
    google.protobuf.Timestamp date_of_birth = 7;
    string gender = 8;
    string phone_number = 9;
    bool is_verified = 10;
    bool by_admin = 11;
    string nationality = 12;
}

message CreateUserHostResponse{
    CreateUserHostRequest data = 1;
    string code = 2;
    string title = 3;
}

message SignUpAsHostRequest{
    string uid = 1;
    string business_name = 2 ;
    string business_category = 3 ;
    string address = 4 ; 
    repeated Setting settings = 5; 
}

message SignUpAsHostRespone{
    SignUpAsHostRequest data = 1;
    string title = 2 ;
    string code = 3 ;
}

message Setting{
    string key = 1;
    string type = 2;
    string value = 3;
}

message UpdateHostUserRequest{
    string uid = 1;
    string first_name = 2;
    string last_name = 3;
    string email = 4;
    string old_password = 5;
    string password = 6;
    string password_confirmation = 7;
    google.protobuf.Timestamp date_of_birth = 8 ;
    string gender = 9;
    string phone_number = 10;
    string profile_picture_url = 11;
    string nationality = 12;
}

message UpdateHostUserRespone{
    UpdateHostUserRequest data = 1;
    string code = 2;
    string title = 3; 
}

message RefundResponse{
    string title = 1; 
    int32 code = 2;
}

message GetAllUserRequest{
    string param = 1;
    string search = 2;
    int32 page = 3;
    int32 per_page = 4;
}

message GetUsers{
    string uid = 1;
    string first_name = 2;
    string last_name = 3;
    string email = 4;
    google.protobuf.Timestamp date_of_birth = 5 ;
    string gender = 6;
    string phone_number = 7;
    string profile_picture_url = 8;
    string nationality = 9;
    google.protobuf.Timestamp created_at = 10 ;
}

message GetAllUserResponse{
    repeated GetUsers data = 1;
    Paginate paginate = 2;
}

message UserDetail{
    string user_uid = 1;
    string first_name = 2;
    string last_name = 3;
    string email = 4;
    string password = 5;
    google.protobuf.Timestamp date_of_birth = 6;
    string gender = 7;
    string phone_number = 8;
    string profile_picture_url = 9;
    bool is_suspended = 10;
    string nationality = 11;
    string host_id = 12;
    string business_name = 13;
    string business_category = 14;
    string address = 15;
    string business_about  = 16;
    string card_id_type = 17;
    string card_id = 18;
    string person_with_id = 19;
    string bussiness_id_type = 20;
    string bussiness_id = 21;
    bool is_host = 22;
    string account_number = 23;
    string balance = 24;
    google.protobuf.Timestamp created_at = 25;
    int32 card_id_status = 26;
    int32 bussiness_id_status = 27;
    string card_number = 28;
    string bussiness_number = 29;
    bool deleted_permanently = 30;
    bool is_deactivate = 31;
}

message UserDetailResponse{
    UserDetail data = 1;
}

message ResponseUser{
    string uid = 1;
    string first_name = 2;
    string last_name = 3;
    string email = 4;
    string password = 5;
    google.protobuf.Timestamp date_of_birth = 6;
    string gender = 7;
    string phone_number = 8;
    string profile_picture_url = 9;
    bool is_verified = 10;
    bool is_suspended = 11;
    string nationality = 12;
    google.protobuf.Timestamp created_at = 13;
    bool deleted_permanently = 14;
    bool is_deactivate = 15;
}

message RequestDelete {
    string uid = 1;
}

message ResponseDelete {
    string title = 1; 
    int32 code = 2;
}


message OldUserResponse {
    string title = 1;
    int32 code = 2;
    OldUser data = 3;
}


message Paginate {
  int32 current_page = 1;
  int32 next_page = 2;
  int32 total_page = 3;
  int32 per_page = 4;
  int32 total = 5;
}

service UserService{

    rpc Deactivate(RequestDelete) returns (ResponseDelete) {
        option (google.api.http) = {
            get    : "/api/v1/users/deactivate/{uid}",
        };
    }

    rpc Reactivate(RequestDelete) returns (ResponseDelete) {
        option (google.api.http) = {
            get    : "/api/v1/users/reactivate/{uid}",
        };
    }


    rpc DeletePermanently(RequestDelete) returns (ResponseDelete) {
        option (google.api.http) = {
            post    : "/api/v1/delete/permanently",
            body    : "*" 
        };
    }

    rpc CreateUser(CreateUserRequest) returns (CreateUserResponse) {
        option (google.api.http) = {
            post    : "/api/v1/users",
            body    : "*" 
        };
    }

    rpc GetUserInfo(User) returns (GetUserInfoRespone){
        option (google.api.http) = {
            get : "/api/v1/users/profile/me",
        };
    }

    rpc Refund(LogsBalance) returns (RefundResponse){
        option (google.api.http) = {
            post : "/api/v1/users/refund/{user_uid}",
            body : "*"
        };
    }

    rpc UpdateUser(UpdateUserRequest) returns (UpdateUserResponse){
        option (google.api.http) = {
            patch : "/api/v1/users/{uid}",
            body : "*"
        };
    }

    rpc GetUser(GetUserRequest) returns (GetUserResponse);

    rpc GetOldUser(GetUserRequest) returns (OldUserResponse){
        option (google.api.http) = {
            get    : "/api/v1/users/olduser/{uid}",
        };
    }

    rpc GetUserByCredentials(GetUserByCredentialsRequest) returns (GetUserByCredentialsResponse);

    rpc EmailVerification(EmailVerificationRequest) returns (EmailVerificationResponse) {
        option (google.api.http) = {
            post    : "/api/v1/users/emailverification",
            body    : "*" 
        };
    }

    rpc ResendVerification(ResendEmailVerificationRequest) returns (ResendEmailVerificationRespone){
        option (google.api.http) = {
            post : "/api/v1/users/resendemailverification",
            body : "*"
        };
    }

    rpc ResetPasswordToken(ResetPasswordTokenRequest) returns (ResetPasswordTokenResponse) {
        option (google.api.http) = {
            post    : "/api/v1/users/resetpasswordtoken",
            body    : "*" 
        };
    }

    rpc ResetPassword(ResetPasswordRequest) returns (ResetPasswordResponse) {
        option (google.api.http) = {
            post    : "/api/v1/users/resetpassword",
            body    : "*" 
        };
    }

    // this endpoint only use for handling a sign up host by admin.
    rpc CreateUserHost(CreateUserHostRequest) returns (CreateUserHostResponse);

    rpc SignUpAsHost(SignUpAsHostRequest)returns(SignUpAsHostRespone){
         option (google.api.http) = {
            post    : "/api/v1/users/{uid}/registerhosts",
            body    : "*" 
        };
    }

    // this endpoint only user for handling for update host profile 
    rpc UpdateHostUser(UpdateHostUserRequest) returns (UpdateHostUserRespone);

    rpc GetUserByID(GetUserRequest) returns (GetUserResponse){
        option (google.api.http) = {
            get : "/api/v1/users/gets/{uid}",
        };
    }

    // this endpoint only use for handle get all user for admin
    rpc GetAllUser(GetAllUserRequest) returns (GetAllUserResponse);

    rpc GetUserDetail(GetUserRequest) returns (UserDetailResponse){
        option (google.api.http) = {
            get : "/api/v1/users/{uid}/details",
        };
    }
}